<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Exchange Fluxes · SurfaceFluxes.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SurfaceFluxes.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SurfaceFluxes.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../SurfaceFluxes/">Surface Fluxes Theory</a></li><li><a class="tocitem" href="../UniversalFunctions/">Universal Functions</a></li><li><a class="tocitem" href="../PhysicalScales/">Physical Scales</a></li><li class="is-active"><a class="tocitem" href>Exchange Fluxes</a><ul class="internal"><li><a class="tocitem" href="#Bulk-Fluxes"><span>Bulk Fluxes</span></a></li><li><a class="tocitem" href="#Exchange-Coefficients"><span>Exchange Coefficients</span></a></li><li><a class="tocitem" href="#Roughness-Length-Models"><span>Roughness Length Models</span></a></li><li><a class="tocitem" href="#Gustiness"><span>Gustiness</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li></ul></li><li><a class="tocitem" href="../PrescribedConditions/">Prescribed Conditions</a></li><li><a class="tocitem" href="../TestSuite/">Test Suite</a></li><li><a class="tocitem" href="../API/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Exchange Fluxes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Exchange Fluxes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/SurfaceFluxes.jl/blob/main/docs/src/ExchangeFluxes.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Exchange-Fluxes"><a class="docs-heading-anchor" href="#Exchange-Fluxes">Exchange Fluxes</a><a id="Exchange-Fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Exchange-Fluxes" title="Permalink"></a></h1><p>SurfaceFluxes.jl provides a robust interface for computing surface-atmosphere exchange. The fluxes are calculated using bulk aerodynamic formulas, parameterized by non-dimensional exchange coefficients derived from Monin-Obukhov Similarity Theory (MOST).</p><h2 id="Bulk-Fluxes"><a class="docs-heading-anchor" href="#Bulk-Fluxes">Bulk Fluxes</a><a id="Bulk-Fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Bulk-Fluxes" title="Permalink"></a></h2><p>The <code>SurfaceFluxes</code> module exports functions to compute the surface fluxes directly. These are the primary physical quantities of interest for coupling.</p><h3 id=".-Momentum-Fluxes-(\\tau)"><a class="docs-heading-anchor" href="#.-Momentum-Fluxes-(\\tau)">1. Momentum Fluxes (<span>$\tau$</span>)</a><a id=".-Momentum-Fluxes-(\\tau)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Momentum-Fluxes-(\\tau)" title="Permalink"></a></h3><p>The surface stress vector [<span>$\mathrm{N~m^{-2}}$</span>], representing the transfer of momentum from the atmosphere to the surface.</p><pre><code class="language-julia hljs">momentum_fluxes(Cd, inputs, ρ_sfc, gustiness)</code></pre><p><strong>Formula:</strong></p><p class="math-container">\[\tau_{x,y} = -\rho_{\text{sfc}} C_d U_{\text{eff}} \Delta u_{x,y}\]</p><p>where:</p><ul><li>The drag coefficient is denoted by <span>$C_d$</span>.</li><li>The effective wind speed <span>$U_{\text{eff}}$</span> includes gustiness effects.</li><li>The wind speed component differences are <span>$\Delta u_{x,y}$</span>.</li><li>The surface density <span>$\rho_{\text{sfc}}$</span> is computed internally by hydrostatically extrapolating the interior pressure to the surface.</li></ul><h3 id=".-Evaporation-(E)"><a class="docs-heading-anchor" href="#.-Evaporation-(E)">2. Evaporation (<span>$E$</span>)</a><a id=".-Evaporation-(E)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Evaporation-(E)" title="Permalink"></a></h3><p>The mass flux of water vapor [<span>$\mathrm{kg/m^2/s}$</span>], driven by the specific humidity gradient.</p><pre><code class="language-julia hljs">evaporation(param_set, inputs, g_h, q_vap_int, q_vap_sfc, ρ_sfc, model)</code></pre><p><strong>Formula:</strong></p><p class="math-container">\[E = -\rho_{\text{sfc}} g_h (q_{\text{vap,int}} - q_{\text{vap,sfc}})\]</p><p>where:</p><ul><li>The surface air density is <span>$\rho_{\text{sfc}}$</span>.</li><li>The term <span>$g_h$</span> represents the <strong>conductance</strong> for heat/scalars [<span>$\mathrm{m~s^{-1}}$</span>].</li><li>The term <span>$(q_{\text{vap,int}} - q_{\text{vap,sfc}})$</span> is the specific humidity difference between the interior (atmosphere) and the surface.</li></ul><p>If a latent heat flux is prescribed in <code>inputs</code>, the evaporation is derived from it: <span>$E = \text{LHF} / L_{v,0}$</span>.</p><h3 id=".-Latent-Heat-Flux-(LHF)"><a class="docs-heading-anchor" href="#.-Latent-Heat-Flux-(LHF)">3. Latent Heat Flux (LHF)</a><a id=".-Latent-Heat-Flux-(LHF)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Latent-Heat-Flux-(LHF)" title="Permalink"></a></h3><p>The energy flux associated with the phase change of water [<span>$\mathrm{W/m^2}$</span>].</p><pre><code class="language-julia hljs">latent_heat_flux(param_set, inputs, E, model)</code></pre><p><strong>Formula:</strong></p><p class="math-container">\[\text{LHF} = L_{v,0} E\]</p><p>where <span>$L_{v,0}$</span> is the latent heat of vaporization at the reference temperature.</p><h3 id=".-Sensible-Heat-Flux-(SHF)"><a class="docs-heading-anchor" href="#.-Sensible-Heat-Flux-(SHF)">4. Sensible Heat Flux (SHF)</a><a id=".-Sensible-Heat-Flux-(SHF)-1"></a><a class="docs-heading-anchor-permalink" href="#.-Sensible-Heat-Flux-(SHF)" title="Permalink"></a></h3><p>The energy flux driven by the temperature difference [<span>$\mathrm{W/m^2}$</span>].</p><pre><code class="language-julia hljs">sensible_heat_flux(param_set, inputs, g_h, T_int, T_sfc, ρ_sfc, E)</code></pre><p><strong>Formula:</strong></p><p class="math-container">\[\text{SHF} = -\rho_{\text{sfc}} g_h (\text{DSE}_{\text{int}} - \text{DSE}_{\text{sfc}}) + \text{VSE}_{\text{sfc}} \times E\]</p><p>This formulation accounts for the enthalpy transport due to sensible heat transfer:</p><ol><li><strong>Dry Static Energy Term</strong>: <span>$-\rho_{\text{sfc}} g_h \Delta \text{DSE}$</span>. Driven by the dry static energy (potential temperature) gradient.</li><li><strong>Mass Transfer Term</strong>: <span>$\text{VSE}_{\text{sfc}} \times E$</span>. Represents the &quot;dry&quot; enthalpy carried by the evaporating water vapor leaving the surface (<span>$\text{VSE}$</span> is Vapor Static Energy, or the dry static energy carried by water vapor).</li></ol><p>See <a href="https://doi.org/10.1029/2025MS005014">Yatunin et al. (2026)</a> for a derivation of these formulas and a detailed explanation of how they result in an energetically consistent formulation.</p><h2 id="Exchange-Coefficients"><a class="docs-heading-anchor" href="#Exchange-Coefficients">Exchange Coefficients</a><a id="Exchange-Coefficients-1"></a><a class="docs-heading-anchor-permalink" href="#Exchange-Coefficients" title="Permalink"></a></h2><p>The non-dimensional exchange coefficients relate the fluxes to the bulk gradients. They are derived from the integrated similarity profiles (<span>$F_m, F_h$</span>) computed by the <code>UniversalFunctions</code> module.</p><h3 id="Drag-Coefficient-(C_d)"><a class="docs-heading-anchor" href="#Drag-Coefficient-(C_d)">Drag Coefficient (<span>$C_d$</span>)</a><a id="Drag-Coefficient-(C_d)-1"></a><a class="docs-heading-anchor-permalink" href="#Drag-Coefficient-(C_d)" title="Permalink"></a></h3><p>For momentum exchange:</p><p class="math-container">\[C_d = \left( \frac{\kappa}{F_m(\Delta z_{\text{eff}}, \zeta, z_{0m})} \right)^2\]</p><p>Momentum flux: <span>$\tau = \rho_{\text{sfc}} C_d U_{\text{eff}} \Delta U$</span>.</p><h3 id="Heat-Exchange-Coefficient-(C_h)"><a class="docs-heading-anchor" href="#Heat-Exchange-Coefficient-(C_h)">Heat Exchange Coefficient (<span>$C_h$</span>)</a><a id="Heat-Exchange-Coefficient-(C_h)-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-Exchange-Coefficient-(C_h)" title="Permalink"></a></h3><p>For heat and scalar exchange:</p><p class="math-container">\[C_h = \frac{\kappa^2}{F_m(\Delta z_{\text{eff}}, \zeta, z_{0m}) F_h(\Delta z_{\text{eff}}, \zeta, z_{0h})}\]</p><h3 id="Conductance-(g_h)"><a class="docs-heading-anchor" href="#Conductance-(g_h)">Conductance (<span>$g_h$</span>)</a><a id="Conductance-(g_h)-1"></a><a class="docs-heading-anchor-permalink" href="#Conductance-(g_h)" title="Permalink"></a></h3><p>The bulk scalar fluxes are proportional to the <strong>conductance</strong> <span>$g_h$</span>, which is the product of the non-dimensional heat exchange coefficient <span>$C_h$</span> and the effective wind speed:</p><p class="math-container">\[g_h = C_h U_{\text{eff}}\]</p><h2 id="Roughness-Length-Models"><a class="docs-heading-anchor" href="#Roughness-Length-Models">Roughness Length Models</a><a id="Roughness-Length-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Roughness-Length-Models" title="Permalink"></a></h2><p>The surface roughness lengths (<span>$z_{0m}, z_{0h}$</span>) parameterize the effect of surface irregularities on the wind and scalar profiles. SurfaceFluxes.jl supports several models via <code>SurfaceFluxFluxConfig</code>.</p><h3 id="Constant-Roughness"><a class="docs-heading-anchor" href="#Constant-Roughness">Constant Roughness</a><a id="Constant-Roughness-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-Roughness" title="Permalink"></a></h3><p><code>ConstantRoughnessParams</code> uses fixed values for <span>$z_{0m}$</span> and <span>$z_{0h}$</span>. This is typical for static land surfaces where roughness is prescribed.</p><h3 id="COARE-3.0-(Ocean)"><a class="docs-heading-anchor" href="#COARE-3.0-(Ocean)">COARE 3.0 (Ocean)</a><a id="COARE-3.0-(Ocean)-1"></a><a class="docs-heading-anchor-permalink" href="#COARE-3.0-(Ocean)" title="Permalink"></a></h3><p><code>COARE3RoughnessParams</code> implements the COARE 3.0 algorithm (<a href="https://doi.org/10.1175/1520-0442(2003)016&lt;0571:BPOASF&gt;2.0.CO;2">Fairall et al., 2003</a>) for open ocean surfaces.</p><ul><li><strong>Momentum Roughness (<span>$z_{0m}$</span>)</strong>: A sum of a smooth flow limit (viscous) and a rough flow limit (Charnock relationship, with a Charnock parameter <span>$\alpha$</span> that varies with wind speed):</li></ul><p class="math-container">\[z_{0m} = 0.11 \frac{\nu}{u_*} + \alpha \frac{u_*^2}{g}\]</p><ul><li><strong>Scalar Roughness (<span>$z_{0h}$</span>)</strong>: Based on Reynolds number scaling.</li></ul><h3 id="Raupach-(Land/Canopy)"><a class="docs-heading-anchor" href="#Raupach-(Land/Canopy)">Raupach (Land/Canopy)</a><a id="Raupach-(Land/Canopy)-1"></a><a class="docs-heading-anchor-permalink" href="#Raupach-(Land/Canopy)" title="Permalink"></a></h3><p><code>RaupachRoughnessParams</code> implements the <a href="https://doi.org/10.1007/BF00709229">Raupach (1994)</a> model for vegetation canopies.</p><ul><li>Calculates <span>$z_{0m}$</span> and displacement height <span>$d$</span> based on canopy height (<span>$h$</span>) and Leaf Area Index (LAI).</li><li>Useful for dynamic vegetation models.</li></ul><h2 id="Gustiness"><a class="docs-heading-anchor" href="#Gustiness">Gustiness</a><a id="Gustiness-1"></a><a class="docs-heading-anchor-permalink" href="#Gustiness" title="Permalink"></a></h2><p>In unstable conditions, especially when the mean wind speed approaches zero (free convection limit), convective eddies generated by surface heating maintain turbulent exchange. Standard bulk formulas using only the mean wind speed difference (<span>$\Delta U$</span>) would erroneously predict zero fluxes.</p><p>To account for this, <code>SurfaceFluxes.jl</code> uses an <strong>effective wind speed</strong> (<span>$U_{\text{eff}}$</span>):</p><p class="math-container">\[U_{\text{eff}} = \max\left( \left(\Delta u^2 + \Delta v^2\right)^{1/2}, \; U_{\text{gust}} \right)\]</p><p>where <span>$U_{\text{gust}}$</span> is a parameterized gustiness velocity scale representing the contribution of sub-grid eddies.</p><h3 id="Parameterizations-and-Dispatch"><a class="docs-heading-anchor" href="#Parameterizations-and-Dispatch">Parameterizations and Dispatch</a><a id="Parameterizations-and-Dispatch-1"></a><a class="docs-heading-anchor-permalink" href="#Parameterizations-and-Dispatch" title="Permalink"></a></h3><p>The gustiness formulation is controlled by the <code>GustinessSpec</code> type in the <code>SurfaceFluxInputs</code>. This design allows for <strong>type-stable dispatch</strong> and straightforward broadcasting over heterogeneous surfaces. For example, a model coupled to both land and ocean can use an array of input structs where some elements use <code>ConstantGustinessSpec</code> (land) and others use <code>DeardorffGustinessSpec</code> (ocean). The solver simply calls <code>surface_fluxes</code> and correct method is dispatched automatically.</p><h4 id=".-Constant-Gustiness"><a class="docs-heading-anchor" href="#.-Constant-Gustiness">1. Constant Gustiness</a><a id=".-Constant-Gustiness-1"></a><a class="docs-heading-anchor-permalink" href="#.-Constant-Gustiness" title="Permalink"></a></h4><pre><code class="language-julia hljs">ConstantGustinessSpec(value)</code></pre><p>Uses a fixed tuning parameter, e.g., <span>$U_{\text{gust}} = 1.0 \, \mathrm{m~s^{-1}}$</span>. Often used over land surfaces.</p><h4 id=".-Deardorff-Gustiness"><a class="docs-heading-anchor" href="#.-Deardorff-Gustiness">2. Deardorff Gustiness</a><a id=".-Deardorff-Gustiness-1"></a><a class="docs-heading-anchor-permalink" href="#.-Deardorff-Gustiness" title="Permalink"></a></h4><pre><code class="language-julia hljs">DeardorffGustinessSpec()</code></pre><p>Scales <span>$U_{\text{gust}}$</span> with the convective velocity scale <span>$w_*$</span>, following <a href="https://doi.org/10.1175/1520-0469(1970)027&lt;1211:CVATSF&gt;2.0.CO;2">Deardorff (1970)</a> and <a href="https://doi.org/10.1002/qj.49712152203">Beljaars (1995)</a>. This is physically robust for the unstable boundary layer over fluid surfaces (ocean/lakes).</p><p class="math-container">\[U_{\text{gust}} = \beta w_* = \beta (B z_i)^{1/3}\]</p><p>where:</p><ul><li>The surface buoyancy flux is denoted by <span>$B$</span>.</li><li>The boundary layer height is <span>$z_i$</span>.</li><li>The scaling coefficient is <span>$\beta$</span> (typically <span>$\approx 1.0$</span>).</li></ul><p>Since <span>$B$</span> depends on the fluxes, and the fluxes depend on <span>$U_{\text{eff}}$</span> (and thus <span>$B$</span>), this introduces a nonlinear coupling that is resolved by an iterative solver.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><ul><li><p>Beljaars, A. C. M. (1995). The parametrization of surface fluxes in large-scale models under free convection. <em>Quarterly Journal of the Royal Meteorological Society</em>, 121, 255-270. <a href="https://doi.org/10.1002/qj.49712152203">DOI: 10.1002/qj.49712152203</a></p></li><li><p>Deardorff, J. W. (1970). Convective velocity and temperature scales for the unstable planetary boundary layer and for Rayleigh convection. <em>Journal of the Atmospheric Sciences</em>, 27, 1211-1213. <a href="https://doi.org/10.1175/1520-0469(1970)027&lt;1211:CVATSF&gt;2.0.CO;2">DOI: 10.1175/1520-0469(1970)027&lt;1211:CVATSF&gt;2.0.CO;2</a></p></li><li><p>Fairall, C. W., Bradley, E. F., Hare, J. E., Grachev, A. A., &amp; Edson, J. B. (2003). Bulk parameterization of air–sea fluxes: Updates and verification for the COARE algorithm. <em>Journal of Climate</em>, 16, 571-591. <a href="https://doi.org/10.1175/1520-0442(2003)016&lt;0571:BPOASF&gt;2.0.CO;2">DOI: 10.1175/1520-0442(2003)016&lt;0571:BPOASF&gt;2.0.CO;2</a></p></li><li><p>Raupach, M. R. (1994). Simplified expressions for vegetation roughness length and zero-plane displacement as functions of canopy height and area index. <em>Boundary-Layer Meteorology</em>, 71, 211-216. <a href="https://doi.org/10.1007/BF00709229">DOI: 10.1007/BF00709229</a></p></li><li><p>Yatunin, D., Byrne, S., Kawczynski, C., Kandala, S., Bozzola, G., Sridhar, A., Shen, Z., Jaruga, A., Sloan, J., He, J., Huang, D.Z., Barra, V., Knoth, O., Ullrich, P., Schneider, T., 2026: The CliMA atmosphere dynamical core: Concepts, numerics, and scaling. <em>Journal of Advances in Modeling Earth Systems</em>, in press. <a href="https://doi.org/10.1029/2025MS005014">DOI:10.1029/2025MS005014</a></p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../PhysicalScales/">« Physical Scales</a><a class="docs-footer-nextpage" href="../PrescribedConditions/">Prescribed Conditions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 20 January 2026 05:56">Tuesday 20 January 2026</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
