var documenterSearchIndex = {"docs":
[{"location":"UniversalFunctions/#Universal-Functions","page":"Universal Functions","title":"Universal Functions","text":"","category":"section"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"UniversalFunctions.jl provides universal functions for SurfaceFluxes.jl. Here, we reproduce some plots from literature, specifically from Gryanik et al. 2020, and Businger.","category":"page"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"using SurfaceFluxes.UniversalFunctions\nusing CLIMAParameters\nusing CLIMAParameters.Planet\nstruct EarthParameterSet <: AbstractEarthParameterSet end;\nconst param_set = EarthParameterSet();\nusing Plots\nFT = Float32;\nζ = FT(-0.1):FT(0.001):FT(0.1);\nL = FT(10);\nargs = (param_set,L)\nuniversal_functions(args) = (Gryanik(args...),\n    Grachev(args...),\n    Businger(args...),)\n\nfunction save_ϕ_figs(args, ζ; ylims=nothing, fig_prefix=\"\", xaxis=:identity, yaxis=:identity)\n    plot()\n    for uf in universal_functions(args)\n        ϕ_m = phi.(uf, ζ, MomentumTransport());\n        name = \"$(typeof(uf).name)\"\n        plot!(ζ, ϕ_m, xlabel=\"ζ\", ylabel=\"ϕ_m\", label=name, ylims=ylims, xaxis=xaxis,yaxis=yaxis)\n    end\n    savefig(\"$(fig_prefix)_phi_m.svg\");\n    plot()\n    for uf in universal_functions(args)\n        ϕ_h = phi.(uf, ζ, HeatTransport());\n        name = \"$(typeof(uf).name)\"\n        plot!(ζ, ϕ_h, xlabel=\"ζ\", ylabel=\"ϕ_h\", label=name, ylims=ylims, xaxis=xaxis,yaxis=yaxis)\n    end\n    savefig(\"$(fig_prefix)_phi_h.svg\")\nend\nfunction save_ψ_figs(args, ζ; ylims=nothing, fig_prefix=\"\", xaxis=:identity, yaxis=:identity)\n    plot()\n    for uf in universal_functions(args)\n        ψ_m = psi.(uf, ζ, MomentumTransport());\n        name = \"$(typeof(uf).name)\"\n        plot!(ζ, ψ_m, xlabel=\"ζ\", ylabel=\"ψ_m\", label=name, ylims=ylims, xaxis=xaxis,yaxis=yaxis)\n    end\n    savefig(\"$(fig_prefix)_psi_m.svg\");\n    plot()\n    for uf in universal_functions(args)\n        ψ_h = psi.(uf, ζ, HeatTransport());\n        name = \"$(typeof(uf).name)\"\n        plot!(ζ, ψ_h, xlabel=\"ζ\", ylabel=\"ψ_h\", label=name, ylims=ylims, xaxis=xaxis,yaxis=yaxis)\n    end\n    savefig(\"$(fig_prefix)_psi_h.svg\");\nend","category":"page"},{"location":"UniversalFunctions/#Figs-1,2-(Gryanik)","page":"Universal Functions","title":"Figs 1,2 (Gryanik)","text":"","category":"section"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"save_ϕ_figs(args, FT(0):FT(0.01):FT(15);ylims=(0,30), fig_prefix=\"Gryanik12\")\nsave_ψ_figs(args, FT(0):FT(0.01):FT(15);ylims=(-25,0), fig_prefix=\"Gryanik12\")","category":"page"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"(Image: ) (Image: ) (Image: ) (Image: )","category":"page"},{"location":"UniversalFunctions/#Fig-3-(Gryanik)","page":"Universal Functions","title":"Fig 3 (Gryanik)","text":"","category":"section"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"save_ϕ_figs(args, 10 .^ (FT(-3):0.1:FT(2)); ylims=(0.1,10^2), xaxis=:log10, yaxis=:log10, fig_prefix=\"Gryanik3\")","category":"page"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"(Image: ) (Image: )","category":"page"},{"location":"UniversalFunctions/#Figs-1,2-(Businger)","page":"Universal Functions","title":"Figs 1,2 (Businger)","text":"","category":"section"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"save_ϕ_figs(args, FT(-2.5):FT(0.01):FT(2);ylims=(-1,8),fig_prefix=\"Businger\")","category":"page"},{"location":"UniversalFunctions/","page":"Universal Functions","title":"Universal Functions","text":"(Image: ) (Image: )","category":"page"},{"location":"References/#References","page":"References","title":"References","text":"","category":"section"},{"location":"References/","page":"References","title":"References","text":"","category":"page"},{"location":"#SurfaceFluxes.jl","page":"Home","title":"SurfaceFluxes.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"SurfaceFluxes","category":"page"},{"location":"#SurfaceFluxes","page":"Home","title":"SurfaceFluxes","text":"SurfaceFluxes\n\nInterface\n\nsurface_conditions computes\nMonin-Obukhov length\nPotential temperature flux (if not given) using Monin-Obukhov theory\ntransport fluxes using Monin-Obukhov theory\nfriction velocity/temperature scale/tracer scales\nexchange coefficients\n\nReferences\n\nS Nishizawa, Y Kitamura (2018)\n\n\n\n\n\n","category":"module"},{"location":"#Universal-Functions","page":"Home","title":"Universal Functions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"SurfaceFluxes.UniversalFunctions","category":"page"},{"location":"#SurfaceFluxes.UniversalFunctions","page":"Home","title":"SurfaceFluxes.UniversalFunctions","text":"UniversalFunctions\n\nUniversal stability and stability correction functions for SurfaceFluxes module.\n\n\n\n\n\n","category":"module"},{"location":"","page":"Home","title":"Home","text":"SurfaceFluxes.UniversalFunctions.Gryanik\nSurfaceFluxes.UniversalFunctions.Grachev\nSurfaceFluxes.UniversalFunctions.Businger","category":"page"},{"location":"#SurfaceFluxes.UniversalFunctions.Gryanik","page":"Home","title":"SurfaceFluxes.UniversalFunctions.Gryanik","text":"Gryanik <: AbstractUniversalFunction{FT}\n\nReferences\n\nVladimir M Gryanik, Christof L{\\\"u}pkes, Andrey Grachev, Dmitry Sidorenko (2020)\n\nEquations in reference:\n\nϕ_m: Eq. 13\nϕ_h: Eq. 13\nψ_m: Eq. 14\nψ_h: Eq. 14\n\nFields\n\nparam_set\nParameter set\nL\nMonin-Obhukov Length\n\n\n\n\n\n","category":"type"},{"location":"#SurfaceFluxes.UniversalFunctions.Grachev","page":"Home","title":"SurfaceFluxes.UniversalFunctions.Grachev","text":"Grachev <: AbstractUniversalFunction{FT}\n\nReferences\n\nAndrey A Grachev, Edgar L Andreas, Christopher W Fairall, Peter S Guest, P Ola G Persson (2007)\n\nEquations in reference:\n\nϕ_m: Eq. 13\nϕ_h: Eq. 13\nψ_m: Eq. 14\nψ_h: Eq. 14\n\nFields\n\nparam_set\nParameter set\nL\nMonin-Obhukov Length\n\n\n\n\n\n","category":"type"},{"location":"#SurfaceFluxes.UniversalFunctions.Businger","page":"Home","title":"SurfaceFluxes.UniversalFunctions.Businger","text":"Businger\n\nReference\n\nS Nishizawa, Y Kitamura (2018)\n\nOriginal research\n\nJoost A Businger, John C Wyngaard, Yꎬ Izumi, Edward F Bradley (1971)\n\nEquations in reference:\n\nϕ_m: Eq. A1\nϕ_h: Eq. A2\nψ_m: Eq. A3\nψ_h: Eq. A4\n\nFields\n\nparam_set\nParameter set\nL\nMonin-Obhukov Length\n\n\n\n\n\n","category":"type"},{"location":"","page":"Home","title":"Home","text":"SurfaceFluxes.UniversalFunctions.phi\nSurfaceFluxes.UniversalFunctions.psi\nSurfaceFluxes.UniversalFunctions.Psi","category":"page"},{"location":"#SurfaceFluxes.UniversalFunctions.phi","page":"Home","title":"SurfaceFluxes.UniversalFunctions.phi","text":"phi\n\nUniversal stability function for wind shear (ϕm) and temperature gradient (ϕh)\n\n\n\n\n\n","category":"function"},{"location":"#SurfaceFluxes.UniversalFunctions.psi","page":"Home","title":"SurfaceFluxes.UniversalFunctions.psi","text":"psi\n\nUniversal stability correction function for momentum (ψm) and heat (ψh)\n\n\n\n\n\n","category":"function"},{"location":"#SurfaceFluxes.UniversalFunctions.Psi","page":"Home","title":"SurfaceFluxes.UniversalFunctions.Psi","text":"Psi\n\nIntegral of universal stability correction function for momentum (ψm) and heat (ψh)\n\n\n\n\n\n","category":"function"},{"location":"#Fluxes-API","page":"Home","title":"Fluxes API","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"SurfaceFluxes.surface_conditions\nSurfaceFluxes.exchange_coefficients\nSurfaceFluxes.recover_profile\nSurfaceFluxes.monin_obukhov_length","category":"page"},{"location":"#SurfaceFluxes.surface_conditions","page":"Home","title":"SurfaceFluxes.surface_conditions","text":"surface_conditions\n\nSurface conditions given\n\nMO_param_guess initial guess for solution (L_MO, u_star, θ_star, ϕ_star, ...)\nx_in Inner values for state variable array x. They correspond to volume averages in FV and  nodal point values in DG\nx_s surface values for state variable array x\nz_0 roughness lengths for state variable array x\nθ_scale virtual dry static energy (i.e., basic potential temperature)\nz_in Input height for the similarity functions. It is Δz for FV and the height  of the first nodal point for DG\nwθ_flux_star potential temperature flux (optional)\nuniversal_func family of flux-gradient universal functions used (optional)\n\nIf wθ_flux_star is not given, then it is computed by iteration of equations 3, 17, and 18 in Nishizawa2018.\n\n\n\n\n\n","category":"function"},{"location":"#SurfaceFluxes.exchange_coefficients","page":"Home","title":"SurfaceFluxes.exchange_coefficients","text":"exchange_coefficients(\n    param_set,\n    z,\n    F_exchange,\n    x_star::VFT,\n    θ_scale,\n    L_MO,\n    universal_func,\n)\n\nComputes exchange transfer coefficients\n\nK_exchange exchange coefficients\n\n\n\n\n\n","category":"function"},{"location":"#SurfaceFluxes.recover_profile","page":"Home","title":"SurfaceFluxes.recover_profile","text":"recover_profile(z, x_star, x_s, z_0, L_MO, transport, ::DGScheme, uf)\n\nRecover vertical profiles u(z), θ(z), ... using equations (4) and (5) for DG and (12), (13) for FV from Nishizawa & Kitamura (2018).\n\nArguments\n\nz Input height for evaluation\nx_star Surface layer scales for state variable array x.\nx_s surface values for state variable array x\nz_0 roughness lengths for state variable array x\nL_MO Obukhov length\ntransport Type of transport (momentum or heat)\nuf universal function family\n\n\n\n\n\n","category":"function"},{"location":"#SurfaceFluxes.monin_obukhov_length","page":"Home","title":"SurfaceFluxes.monin_obukhov_length","text":"monin_obukhov_length(param_set, u_star, θ_scale, wθ_surf_flux)\n\nReturns the Monin-Obukhov length.\n\n\n\n\n\n","category":"function"}]
}
